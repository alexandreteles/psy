<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<link rel="icon" type="image/png" href="assets/img/favicon.ico">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title>PSY - Ferramenta de Assistência ao Diagnóstico Psiquiátrico</title>

	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />

    <!-- Bootstrap core CSS     -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Animation library for notifications   -->
    <link href="assets/css/animate.min.css" rel="stylesheet"/>

    <!--  Light Bootstrap Table core CSS    -->
    <link href="assets/css/light-bootstrap-dashboard.css" rel="stylesheet"/>

    <!--  CSS for Demo Purpose, don't include it in your project     -->
    <link href="assets/css/demo.css" rel="stylesheet" />

    <!--     Fonts and icons     -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300' rel='stylesheet' type='text/css'>
    <link href="assets/css/pe-icon-7-stroke.css" rel="stylesheet" />

	<style type="text/css">
		/* Start by setting display:none to make this hidden.
		   Then we position it in relation to the viewport window
		   with position:fixed. Width, height, top and left speak
		   for themselves. Background we set to 80% white with
		   our animation centered, and no-repeating */
		.modal {
		    display:    none;
		    position:   fixed;
		    z-index:    1000;
		    top:        0;
		    left:       0;
		    height:     100%;
		    width:      100%;
		    background: rgba( 255, 255, 255, .8 ) 
		                url('http://i.stack.imgur.com/FhHRx.gif') 
		                50% 50% 
		                no-repeat;
		}
		
		/* When the body has the loading class, we turn
		   the scrollbar off with overflow:hidden */
		body.loading {
		    overflow: hidden;   
		}
		
		/* Anytime the body has the loading class, our
		   modal element will be visible */
		body.loading .modal {
		    display: block;
		}
	</style>
</head>
<body>

<div class="wrapper">
    <div class="sidebar" data-color="purple" data-image="assets/img/sidebar-5.jpg">

    	<div class="sidebar-wrapper">
            <div class="logo">
                <img src="assets/img/logo.png" style="width:100%; height:100%;" />
            </div>
            
    	</div>
    </div>

    <div class="main-panel">
        <nav class="navbar navbar-default navbar-fixed">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigation-example-2">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
            </div>
        </nav>

        <div class="content">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">Análise de tons de emoção</h4>
                            </div>
                            <div class="content">
                                <div id="myChart" class="ct-chart" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto">
                                </div>
                                
                                <div class="footer">
                                    <div class="legend">
                                        <i class=" text-info">
                                 
                                      <label id="analises" class="title" style="height: 20px;"></label>
                                        </i>
                                    </div>
                                    <hr>
                                
                            </div>
                        </div>
                    </div>
                
                    <div class="col-md-6">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">Análise de percepção de personalidade</h4>
                            </div>
                            <div class="content">
                                <div id="pieChart" class="ct-chart" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">Análise de valores</h4>
                            </div>
                            <div class="content">
                                <div id="valoresChart" class="ct-chart" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-12">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">Análise de necessidades</h4>
                            </div>
                            <div class="content">
                                <div id="needChart" class="ct-chart" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

        <footer class="footer">
            <div class="container-fluid">
                <p class="copyright pull-right">
                    &copy; <script>document.write(new Date().getFullYear())</script> Team Corujão
                </p>
            </div>
        </footer>

    </div>
</div>

<div class="modal"><!-- Place at bottom of page --></div>

</body>

    <!--   Core JS Files   -->
    <script src="assets/js/jquery-1.10.2.js" type="text/javascript"></script>
	<script src="assets/js/bootstrap.min.js" type="text/javascript"></script>

	<!--  Checkbox, Radio & Switch Plugins -->
	<script src="assets/js/bootstrap-checkbox-radio-switch.js"></script>

	<!--  Charts Plugin -->
	<script src="assets/js/chartist.min.js"></script>

    <!--  Notifications Plugin    -->
    <script src="assets/js/bootstrap-notify.js"></script>

    <!-- Light Bootstrap Table Core javascript and methods for Demo purpose -->
	<script src="assets/js/light-bootstrap-dashboard.js"></script>

	<!-- Light Bootstrap Table DEMO methods, don't include it in your project! -->
	<script src="assets/js/demo.js"></script>
	
	<script src="https://code.highcharts.com/highcharts.js"></script>
	<script src="https://code.highcharts.com/modules/exporting.js"></script>
	
	<script type="text/javascript">
		$body = $("body");
	
		$(document).on({
		    ajaxStart: function() { $body.addClass("loading");    },
		     ajaxStop: function() { $body.removeClass("loading"); }    
		});
		
		$(document).ready(function() {
			var twitter = window.location.search.substring(1).split('&')[0].split('=')[1];
			        
			$.post("/efetuarAnalise", { twitterhandle : twitter }, function( data ) {
				var result = JSON.parse(data);

				var tones = result.objects[0].document_tone.tone_categories[0].tones;
				
			  	console.log( tones );
			  	
			  	<!-- Pie chart de tons -->
			  	
			  	Highcharts.chart('myChart', {
				    chart: {
				        plotBackgroundColor: null,
				        plotBorderWidth: null,
				        plotShadow: false,
				        type: 'pie'
				    },
				    title: {
				        text: 'Tons de emoção'
				    },
				    tooltip: {
				        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
				    },
				    plotOptions: {
				        pie: {
				            allowPointSelect: true,
				            cursor: 'pointer',
				            dataLabels: {
				                enabled: true,
				                format: '<b>{point.name}</b>: {point.percentage:.1f} %',
				                style: {
				                    color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
				                }
				            }
				        }
				    },
				    series: [{
				        name: 'Tons de emoção',
				        colorByPoint: true,
				        data: [{
				            name: 'Raiva',
				            y: tones[0].score
				        }, {
				        	name: 'Desgosto',
				            y: tones[1].score
				        }, {
				        	name: 'Medo',
				            y: tones[2].score
				        }, {
				        	name: 'Alegria',
				            y: tones[3].score
				        }, {
				        	name: 'Tristeza',
				            y: tones[4].score
				        }]
				    }]
				});

				var raiva = tones[0].score;
				var desgosto = tones[1].score;
				var medo = tones[2].score;
				var tristeza = tones[4].score;
				var alegria = tones[3].score;
				var negativa = (raiva + desgosto+ medo + tristeza)/4;
				
				console.log("Raiva e Desgosto "+ (raiva + desgosto+ medo + tristeza) );
				console.log("Alegria "+ alegria);
				console.log("Negativa "+ negativa); 

				if (negativa > alegria) {
					document.getElementById('analises').innerHTML = "Com tendência a transtornos afetivos";
				} else if (negativa < alegria) {
					document.getElementById('analises').innerHTML = "Sem tendência a transtornos afetivos";
				} else {
					document.getElementById('analises').innerHTML = "Necessita de avaliacao com especialista";
				}
			  	
			  	<!-- Bar chart -->
			  	
				var personality = result.objects[1].personality[4].children;
			  	
				console.log(personality);
				
			  	Highcharts.chart('pieChart', {
			  	    title: {
			  	        text: 'Percepção de personalidade'
			  	    },
			  	    xAxis: {
			  	        categories: ['Inflamado', 'Propenso a preocupação', 'Melancolia', 'Imoderação', 'Auto-consciencia', 'Sucetível ao estresse']
			  	    },
				  	  yAxis: {
				          min: 0,
				          title: {
				              text: 'Valores %'
				          }
				      },
			  	    series: [{
			  	        type: 'column',
			  	        colorByPoint: true,
			  	        data: [
			  	        	personality[0].percentile * 100, 
	  	        			personality[1].percentile * 100, 
	  	        			personality[2].percentile * 100, 
			  	        	personality[3].percentile * 100, 
			  	        	personality[4].percentile * 100, 
			  	        	personality[5].percentile * 100
			  	        ],
			  	        showInLegend: false
			  	    }]
			  	});
			  	
			  	<!-- Values -->
			  	
			  	Highcharts.chart('valoresChart', {
			  	    title: {
			  	        text: 'Percepção de valores'
			  	    },
			  	    xAxis: {
			  	        categories: ['Conservação', 'Abertura a mudança', 'Hedonismo', 'Auto-aperfeiçoamento', 'Auto-transcendência']
			  	    },
				  	  yAxis: {
				          min: 0,
				          title: {
				              text: 'Valores %'
				          }
				      },
			  	    series: [{
			  	        type: 'column',
			  	        colorByPoint: true,
			  	        data: [
			  	        	result.objects[1].values[0].percentile * 100, 
			  	        	result.objects[1].values[1].percentile * 100, 
			  	        	result.objects[1].values[2].percentile * 100, 
			  	        	result.objects[1].values[3].percentile * 100, 
			  	        	result.objects[1].values[4].percentile * 100
			  	        ],
			  	        showInLegend: false
			  	    }]
			  	});
				
				<!-- Needs -->
			  	
				Highcharts.chart('needChart', {
			  	    title: {
			  	        text: 'Percepção de necessidades'
			  	    },
			  	    xAxis: {
			  	        categories: [
			  	        	'Desafio', 
			  	        	'Proximidade', 
			  	        	'Curiosidade', 
			  	        	'Excitação', 
			  	        	'Harmonia', 
			  	        	'Ideal',
			  	        	'Liberdade',
			  	        	'Amor',
			  	        	'Praticidade',
			  	        	'Auto-expressão',
			  	        	'Estabilidade',
			  	        	'Estrutura'
			  	       	]
			  	    },
				  	  yAxis: {
				          min: 0,
				          title: {
				              text: 'Valores %'
				          }
				      },
			  	    series: [{
			  	        type: 'column',
			  	        colorByPoint: true,
			  	        data: [
			  	        	result.objects[1].needs[0].percentile * 100, 
			  	        	result.objects[1].needs[1].percentile * 100, 
			  	        	result.objects[1].needs[2].percentile * 100, 
			  	        	result.objects[1].needs[3].percentile * 100, 
			  	        	result.objects[1].needs[4].percentile * 100, 
			  	        	result.objects[1].needs[5].percentile * 100, 
			  	        	result.objects[1].needs[6].percentile * 100, 
			  	        	result.objects[1].needs[7].percentile * 100, 
			  	        	result.objects[1].needs[8].percentile * 100, 
			  	        	result.objects[1].needs[9].percentile * 100, 
			  	        	result.objects[1].needs[10].percentile * 100
			  	        ],
			  	        showInLegend: false
			  	    }]
			  	});
			});
		});
	</script>

</html>
